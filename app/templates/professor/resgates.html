{% extends "base.html" %}
{% block title %}Gerenciar Resgates{% endblock %}

{% block content %}
<div class="page-title glow-text">
  <i class="bi bi-bag-check-fill"></i> GERENCIAR RESGATES
</div>

{% if resgates %}
<div class="card">
  <div class="card-body p-0">
    <table class="table-dark-custom w-100">
      <thead>
        <tr>
          <th>#</th>
          <th>ALUNO</th>
          <th>RECOMPENSA</th>
          <th>CUSTO</th>
          <th>DATA</th>
          <th>STATUS</th>
          <th>A√á√ïES</th>
        </tr>
      </thead>
      <tbody>
        {% for r in resgates %}
        <tr>
          <td style="color:var(--text-muted);">{{ r.id }}</td>
          <td><strong>{{ r.aluno.nome }}</strong></td>
          <td>{{ r.recompensa.nome }}</td>
          <td><span class="tc-badge">ü™ô {{ r.recompensa.custo_teccoins }}</span></td>
          <td style="color:var(--text-muted); font-size:0.85rem;">
            {{ r.data.strftime('%d/%m/%Y %H:%M') }}
          </td>
          <td>
            {% if r.status == 'pendente' %}
              <span style="color:#fbbf24; font-weight:700;">‚è≥ Pendente</span>
            {% elif r.status == 'aprovado' %}
              <span style="color:var(--accent); font-weight:700;">‚úÖ Aprovado</span>
            {% else %}
              <span style="color:#f87171; font-weight:700;">‚ùå Recusado</span>
            {% endif %}
          </td>
          <td>
            {% if r.status == 'pendente' %}
            <form method="POST"
                  action="{{ url_for('professor.aprovar_resgate', resgate_id=r.id) }}"
                  style="display:inline;">
              <button class="btn btn-sm btn-accent me-1">
                <i class="bi bi-check-circle"></i> Aprovar
              </button>
            </form>
            <form method="POST"
                  action="{{ url_for('professor.recusar_resgate', resgate_id=r.id) }}"
                  style="display:inline;">
              <button class="btn btn-sm"
                      style="background:rgba(239,68,68,0.15); color:#f87171; border:1px solid rgba(239,68,68,0.3);">
                <i class="bi bi-x-circle"></i> Recusar
              </button>
            </form>
            {% else %}
            <span style="color:var(--text-muted); font-size:0.85rem;">‚Äî</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% else %}
<div class="card">
  <div class="card-body text-center py-5" style="color:var(--text-muted);">
    <i class="bi bi-bag" style="font-size:3rem; color:var(--accent2);"></i>
    <p class="mt-2">Nenhum resgate solicitado ainda.</p>
  </div>
</div>
{% endif %}
{% endblock %}
