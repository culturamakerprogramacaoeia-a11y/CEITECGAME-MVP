{% extends "base.html" %}
{% block title %}Alunos{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <div class="page-title glow-text mb-0">
    <i class="bi bi-people-fill"></i> ALUNOS
  </div>
  <a href="{{ url_for('professor.criar_aluno') }}" class="btn btn-accent">
    <i class="bi bi-person-plus-fill"></i> Novo Aluno
  </a>
</div>

<!-- Filtro por turma -->
{% if turmas %}
<div class="card mb-3">
  <div class="card-body p-3">
    <form method="GET" class="d-flex gap-2 align-items-center">
      <label class="form-label mb-0" style="white-space:nowrap;">Filtrar turma:</label>
      <select name="turma_id" class="form-select form-select-sm" style="max-width:200px;"
              onchange="this.form.submit()">
        <option value="">Todas as turmas</option>
        {% for t in turmas %}
        <option value="{{ t.id }}" {% if turma_selecionada == t.id %}selected{% endif %}>
          {{ t.nome }}
        </option>
        {% endfor %}
      </select>
    </form>
  </div>
</div>
{% endif %}

{% if alunos %}
<div class="card">
  <div class="card-body p-0">
    <table class="table-dark-custom w-100">
      <thead>
        <tr>
          <th>NOME</th>
          <th>EMAIL</th>
          <th>TURMA</th>
          <th>N√çVEL</th>
          <th>XP</th>
          <th>TECCOINS</th>
          <th>A√á√ÉO</th>
        </tr>
      </thead>
      <tbody>
        {% for aluno in alunos %}
        <tr>
          <td><strong>{{ aluno.nome }}</strong></td>
          <td style="color:var(--text-muted); font-size:0.9rem;">{{ aluno.email }}</td>
          <td style="color:var(--text-muted);">
            {{ aluno.turma.nome if aluno.turma else '‚Äî' }}
          </td>
          <td>
            <span class="badge-nivel nivel-{{ aluno.nivel }}">{{ aluno.nivel }}</span>
          </td>
          <td><span class="xp-badge">‚ö° {{ aluno.xp_total }}</span></td>
          <td><span class="tc-badge">ü™ô {{ aluno.teccoins_total }}</span></td>
          <td>
            <a href="{{ url_for('professor.lancar_pontuacao') }}"
               class="btn btn-sm btn-outline-accent">
              <i class="bi bi-plus"></i> Pontuar
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% else %}
<div class="card">
  <div class="card-body text-center py-5" style="color:var(--text-muted);">
    <i class="bi bi-people" style="font-size:3rem; color:var(--accent2);"></i>
    <p class="mt-2">Nenhum aluno encontrado.</p>
    <a href="{{ url_for('professor.criar_aluno') }}" class="btn btn-accent">
      Cadastrar aluno
    </a>
  </div>
</div>
{% endif %}
{% endblock %}
